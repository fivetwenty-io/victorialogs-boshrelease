#!/bin/bash
set -e

echo "vmstorage pre-start: preparing runtime environment..."

# Create storage data directory
echo "Creating vmstorage data directory at <%= p('vlstorage.storage_path') %>"
mkdir -p <%= p('vlstorage.storage_path') %>
chown -R vcap:vcap <%= p('vlstorage.storage_path') %>

# Create run directories for bpm
mkdir -p /var/vcap/sys/run/vlstorage
chown -R vcap:vcap /var/vcap/sys/run/vlstorage

# Create log directory
mkdir -p /var/vcap/sys/log/vlstorage
chown -R vcap:vcap /var/vcap/sys/log/vlstorage

echo "vmstorage pre-start configuration complete"
